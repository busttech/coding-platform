<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Code Executor</title>
    <link rel="stylesheet" href="{{url_for('static',filename = 'styles.css')}}"  />
</head>
<body>
    <div class="container">
        <!-- Description Section (Left Side) -->
        <div class="description-section">
            <h2>Python Code Executor</h2>
            <p>Write your Python code in the editor on the right. Once you're ready, click the "Run Code" button to execute your code. The output will appear below the editor. You can try testing simple scripts or solving coding problems here!</p>
        </div>

        <!-- Code Runner Section (Right Side) -->
        <div class="code-section">
            <form id="codeForm">
                <textarea id="code" placeholder="Write your Python code here..."></textarea>
                <br>
                <button type="submit">Run Code</button>
            </form>
            <div id="result" class="output"></div>
        </div>
    </div>

    <script>
        const form = document.getElementById('codeForm');
        const resultDiv = document.getElementById('result');
        const codeArea = document.getElementById('code');

        form.addEventListener('submit', function (e) {
            e.preventDefault(); // Prevent form submission

            const code = codeArea.value;

            // Make API request to Flask backend to run the code
            fetch('/run_code', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ code })
            })
            .then(response => response.json())
            .then(data => {
                // Display the output in the result div
                resultDiv.textContent = data.output;
                resultDiv.classList.remove('error');
                if (data.status === 'error') {
                    resultDiv.classList.add('error');
                }
            })
            .catch(error => {
                resultDiv.textContent = 'An error occurred while executing the code.';
                resultDiv.classList.add('error');
            });
        });

        // Automatically indent after colon and enter key
        codeArea.addEventListener('keydown', function(event) {
            const cursorPosition = codeArea.selectionStart;
            const codeText = codeArea.value;

            // Check if colon is entered and enter is pressed
            if (event.key === 'Enter') {
                // Check if the line ends with a colon
                const lineBeforeCursor = codeText.substring(0, cursorPosition);
                const lastLine = lineBeforeCursor.split('\n').pop();

                if (lastLine.trim().endsWith(':')) {
                    // Add indentation (4 spaces)
                    const indentation = '    '; // 4 spaces for indentation
                    codeArea.value = codeText.substring(0, cursorPosition) + '\n' + indentation + codeText.substring(cursorPosition);
                    codeArea.setSelectionRange(cursorPosition + indentation.length + 1, cursorPosition + indentation.length + 1);
                    event.preventDefault(); // Prevent default Enter behavior
                }
            }
        });

        // Disable copy, cut, paste, and drag-and-drop in the textarea
        codeArea.addEventListener('copy', function(event) {
            event.preventDefault();
            alert('Copying is disabled in this editor.');
        });

        codeArea.addEventListener('cut', function(event) {
            event.preventDefault();
            alert('Cutting is disabled in this editor.');
        });

        codeArea.addEventListener('paste', function(event) {
            event.preventDefault();
            alert('Pasting is disabled in this editor.');
        });

        // Block drag and drop functionality
        codeArea.addEventListener('dragstart', function(event) {
            event.preventDefault();
        });

        codeArea.addEventListener('dragover', function(event) {
            event.preventDefault();
        });

        codeArea.addEventListener('drop', function(event) {
            event.preventDefault();
            alert('Drag and drop is disabled in this editor.');
        });
    </script>
</body>
</html>



